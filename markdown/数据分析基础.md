# 数据分析基础

## 平均值

1. 从概念上看，平均值有很多种。单从数学上来说，就有算术平均值、几何平均值、平方平均值、调和平均值、加权平均值等等。

### 平均值在什么情况下才有价值

1. 平均值是用所有的样本数据进行计算的，容易受到极端值的影响。在不少情况下，平均值是没有价值的，它无法客观准确的反应数据的整体情况，更进一步来说，整体平均值实在数据成分布均匀或者正态分布的情况下才有意义，如果忽略整个数据的分布情况，只提平均值其实是没有意义的。
2. 整体平均值不能代表各分组情况，分组结论和整体平均值结论可能会大相径庭。
3. 辛普森悖论：在分组比较中都站优势的一方，有的时候在总评中反而是失势的一方，用一句话来讲，就是“质”（命中率）与“量”（投球数）是两个维度的数据，如果全部合并成“质”（命中率）这个维度的数据，那就会出错了。每次小范围内的输赢，其实和你在整体上的输赢没有太大直接的关系。这也是为什么在打麻将或者打德扑真正赢的那些人，不是那些小牌把把赢的人，而往往是赢一把大的人。

4. 看到一个平均值的时候，需要查看看它的数据构成情况，而不是简单地用平均值去代表所有的整体。

### 总结

​	整体平均值是在数据均匀分布或者正态分布下才会有意义，如果忽略整个数据的分布情况，只提平均值是没有价值的。分组结论和整体平均值结论可能会大相径庭。

## 大数定律和小数陷阱

### 什么是大数定律

1. 大数定律是由瑞士数学家雅各布·伯努利提出来并验证的，它的核心逻辑是说当随机事件发生的次数足够多时，发生的频率才会趋近于预期的概率。

### 什么是小数陷阱

1. 当我们了解了大数定律后，大概率认为随着数据的增多，整体趋势会趋向于50%。那么我们在赌场玩轮盘赌大小的时候，然后前面开的都是大，那么我们接下来应该向小的去加倍下注。因为理论上长期来看出现“大”和“小”的概率应该是趋于一致的，所以未来出现“小”的概率应该增大。
2. 每次的事件其实和上一次的事件是独立且随机的，并不是前面都是“大”，后面开“小”的概率就会高。

### 大数定律和小数陷阱给我们的启示

​	对于大数定律来说，我们做事不要轻易跟风，开始某件事之前要想好自己是否有持续投入的能力。

​	对于小数陷阱来说，我们要保持一颗平常心，当我们在做某一件事的时候，如果失败了，要有平常心态。气馁或者赌徒心理都是不可取的。你需要意识到，我们在生活中的数，绝大多数都不够大，所以我们的偶然只是偶然，并不是我们这段时间就该倒霉。

### 总结

​	多利用前人的经验，站在前人的实验结果和规律上，多去学习、阅读。多去经历、总结自己想从事的事业。相信绝大多数人是做不到在赌博中拥有足够大的“大数”，但是没关系，你可以根据自己的生活去建立属于自己的“大数定律”，赋予偶然的生活必然性。

​	大数定律说的是当随机事件发生的次数足够多时，发生的频率就趋近于预期的概率。对于一件事情，你需要持续不断努力，才可以达到你的期望值。而“小数陷阱”则告诉你，每个事件都是独立的事件，“否极泰来”需要足够多的次数才可能出现，做事情要少一些“赌徒心态”，多一些平常心，不要盲目跟风和下注才能获得最后的成功。

## 数据的期望值

### 墨菲定律

​	如果有两种或两种以上的方式去做某件事情，而其中一种选择方式将导致灾难，则必定有人会做出这种选择。

+ 任何事情都不会像它表面上看起来那么简单； 
+ 所有任务的完成周期都会比你预计的长； 
+ 任何事情只要有出错的可能，就会有极大的概率出错； 
+ 如果你预感某件事可能出错，它一定会出错。 

### 期望值

1. 期望值就是对可能出现的结果以概率为权做加权平均。
2. 当样本量 N 趋近无穷大的时候，样本的平均值无限接近数学期望。
3. 期望就是反映在大数定律下多次执行某件事情之后，得到的一个最可能的收益结果。

### 解释墨菲定律

​	人都有一个特殊的心理机制，那就是倾向于记住一些不好的事情。就像航班晚点的概率对每一个人而言都是一样的，但对我来讲，每次飞机晚点的等待就会让我印象深刻，而平时没有晚点的时候，我的注意力都集中在其他事情上。

> ​	抽象一下，你经常担心一个坏事的发生，比如说事情 A，我们假设 A 发生时对你产生的心理作用是 X，事情 A 不发生对你产生的心理作用是 Y。这个时候显然 X 是大于 Y 的，所以当发生 A 这件事情的时候，你受到的心理影响 X 就比 Y 大。
>
> ​	 其实，你在担心一件事情的发生之时，这件事情已经具备了发生的大多数条件。我们假设事件 A 发生的概率是 R，那么当你担心这件事情发生（R1）和不担心这件事情发生（R2）的时候，两个概率是不一样的，R1 一定大于 R2。

### 如何规避墨菲定律

​	对于心理影响来说，我们要做的就是不断调整事情对你心里影响的预期，让它们趋同。特别是遇到坏事情的时候，你可以通过增加 B 计划等方式，调整预期以降低坏事情发生对你的心理影响。 

​	对风险的概率来说，你可以优化流程，提高自身能力，尽可能减少事件出错的概率。 

​	 “为大概率坚持，为小概率备份”——创业的时候，我们要努力为好的期望（N）去坚持，同时考虑为坏的影响（X）备份，应该尽力降低坏期望（R1）的风险。

​	 “已知的是成本，未知的才是风险”——如果坏的影响（X）为已知，那么即使你按照坏事件发生概率（R1）100% 来准备资金，这批资金也算是你付出的成本；但如果坏影响（X）未知，那么无论坏事件发生概率（R1）为多少，都是风险，因为你不知道这个坏事件究竟会造成多大的影响。

​	“项目风险控制”——项目管理当中有各种风险管理和预防措施，把风险分为很多类，例如静态风险、动态风险、局部风险、整体风险，同时也会把风险应对措施细分为很多类，其实背后的核心是为了去避免墨菲定律的发生，让整体项目在项目经理的期望值下正确运行。

​	 “生活中的风险控制”——我们在生活中，其实也是可以借用这种风险控制的方法论，识别生活中的风险并做好准备，这样才能够在墨菲定律发生的时候不会手忙脚乱。例如提前看看天气预报，查看这趟航班的过往准点率，预估自己乘坐航班情况。在去重要会议的时候，多提前一些时间。这些生活里的小事你或许平时不会太过于在意，但请相信，一旦你把这些小事落到实处，你对生活的掌控力会大大提升。

### 总结

​	通过墨菲定律介绍了一个有意思的概念叫期望值（Mean），它是对可能出现的结果的概率加权平均，期望值完全是由概率分布决定。而我们之前讲的平均值一般是指算数平均值，也就是一组数据中所有数据之和再除以数据的个数。某个事情长期不断发生，次数足够多后会达到我们预设的期望值，这就是大数定律。

​	对平均值来说，你要学会为不同事物去分组，用更细分的数据来看待问题。对于大数定律来说，要成事，其实需要我们不要有赌徒心态，要学会持续投入。而对于期望值来说，平衡预期和未雨绸缪这两个词，希望你能够在生活中灵活运用。 

​	其实，这几个数据分析的概念都告诉我们一个最朴实的道理：没有事情可以一蹴而就（平均值），我们需要努力足够多的次数（大数定律），学会规避风险（期望值）。这样最终在若干年后，企业和个人才能有一份满意的企业 / 个人数据报表。

## 随机对照实验

### 你认为的随机其实都是伪随机

​	所谓的伪随机，就是看上去产生的过程似乎是随机的，但实际上是确定的。例如计算的随机数，这是通过确定性算法计算出来的，让你随机一个数字，这也是根据你个人习惯偏好想出来的，他们都输入伪随机数。

### 随机对照试验

​	当我们不知道客观世界里一个问题的真正答案的时候，可以通过少量的数据来验证非常大的数据规律。

> 随机对照试验是由“现代统计学之父”、数据分析的鼻祖——罗纳德·艾尔默·费希尔在《试验设计》一书中提出的。费希尔设计了一个试验：他在那位女士看不见的地方，为她准备了两种冲泡方法不同的奶茶。之后把奶茶随机摆成一排，共 10 杯，让女士随机品尝奶茶并说出其冲泡方式，结果那位女士的回答完全准确。这时费希尔得出结论：这位女士真的有某种方法可以分辨出按不同方法冲泡的奶茶。
>
> 因此只有在随机的情况下这个公式才能成立： 
>
> 如果给女士一杯奶茶，偶然猜对的概率是 1/2，也就是 50%；
>
> 如果随机给女士五杯奶茶，那么她都偶然猜对的概率就是 1/2 的 5 次方，大概 3.1%；
>
> 如果这位女士随机品尝了十杯奶茶，那么偶然猜对的概率，也就是 2 的 10 次方分之一，也就是约 0.1%。

这种试验的重点有两个：一是“随机”，二是对照试验。

### 幸存者偏差并不是随机对照试验

​	幸存者偏差就是当取得资讯的渠道仅来自幸存者时，我们得出的结论可能会与实际情况存在偏差。因为这样做看上去结果的确是由随机对照试验产生，但在逻辑上是错误的，这其实是在用结果来倒推整个前期数据的产生过程。并没有“预言帝”和“赌神”的存在，我们看到的只是大规模数据背后的“幸存者”。

### 总结

​	在我们工作和生活当中，一定要注意不能犯同样的“错误”——采用非随机的结果来证明我们的观点，更不能用幸存者偏差——拿结果倒推原因来解释我们的一些结论。 注意自己“不犯错”是一方面，另一方面我们也要学会“发现错误”，学习前人失败的经验教训。

​	当在工作生活里别人和你兜售一些貌似合理论调时，希望你对“沉默的数据”留一个心眼，在看向那些闪闪发光的成功数据时，也要意识到有很多“话少”甚至“不说话”的数据存在。

## 直方图与幂分布

### 直方图与柱状图

1. 直方图是展示数据的分布，而柱状图是比较数据的大小。
2. 直方图是针对定量数据分布的定性分析，柱状图是对分类数据的定量数据分析。
3. 对直方图来说，它的柱子宽度代表区间的长度，根据区间的不同，柱子宽度可以不同。但柱状图的柱子宽度没有数值含义，所以宽度必须一致。

### 神奇的直方图

1. 直方图最早是由数据统计学家 Karl Pearson 在 1891 年引入，它可以用来统计现实生活中各种各样的数据分布情况。

### 幂律分布与帕累托法则

​	幂率分布也叫做指数分布，你会发现在这种分布里，X 轴的开始的地方数值很高（或很低），然后以指数级的下降（或上升）到 X 轴的末尾段，按照统计学定义叫做：“分布密度函数是幂函数的分布”。

​	帕累托法就是二八法则。 二八法则简单来说，就是 20% 的人占了 80% 的资源，剩下 80% 的人分最后 20% 的资源。这个法则诞生于帕累托的花园。有一天帕累托偶然发现，自己园子里绝大部分的豌豆是由园子里极少部分豌豆荚产生。

### 总结

​	一个是非常简单但有效的工具——直方图。直方图可以让你从混沌的数据里面找到其中的规律。很多的数据分布都会用到这个工具。

​	幂律分布这个统计学规律告诉我们，我们身处的世界是赢者通吃的世界，开始时细微优势最终将带来无穷多的回报。反之，最初的细微劣势也将导致最终一无所有。这个现象也有人称之为“马太效应”，在圣经《新约·马太福音》中是这样描述的：“ 凡有的，还要加给他，叫他多余。没有的，连他所有的也要夺过来 ”。

## 数据分布

​	在实际生活当中，我们最常见的是正态分布和拉普拉斯分布，这两个分布反映了现实生活当中隐藏在数据背后的“势”。了解这些数据的趋势，才可以让你更好地了解实际的工作和生活本身。

### 正态分布

​	最早用正态曲线描述数据的人，是德国著名数学家高斯，为了纪念他，有时候我们也把正态分布称为高斯分布。

​	如果一个量是由许多微小的独立随机因素影响的结果，那么就可以认为这个量具有正态分布。所以大数定律和中心极限定理说的不是一个维度的事情。大数定律算的是概率，中心极限定理算的是样本和的分布。

### 拉普拉斯分布

​	拉普拉斯分布，是一个“凸”字形的塔尖儿曲线，从左到右，斜率先缓慢增大再快速增大，到达最高点后变为负值继续先快速减小，最后再缓慢地减小，所以有点像“往里边凹陷的金字塔”。 对比正态分布的概率密度函数图像，我们可以看到拉普拉斯分布图像是尖峰厚尾的，塔尖上的那些，就是我们看到的稀缺资源。

​	在信息透明和市场竞争的情况下，工资、房价、股票都会符合一个特点：越塔尖的个体越具有资源吸附能力。那么在整体资源恒定的情况下，这已经不是一个简单的符合随机分布的市场了，简单来讲，“大势”变了。

## 散点图和相关性

### 散点图的历史

​	散点图被称之为万图之王。在 1913 年，美国一个叫做亨利·诺利斯·罗素（Henry Norris Russell）的天文学家用散点图把宇宙的趋势给揭示了出来。

### 散点图的制作原则

​	第一，散点图反映的是两个变量之间的关系。因此你要把两个变量分别放在 X 轴和 Y 轴上面，不要有第三个变量放进来进行混淆。当然，散点图的变种——气泡图有更多维度，但是从趋势角度来看，还是要把最重要的两个变量分别放在 X 轴和 Y 轴。

​	第二，为了能够明确展示数据之间的趋势，我们的 Y 轴必须要从零开始。这点就和很多的柱状图不同了。很多柱状图的坐标轴为了表示数据的清晰，Y 轴可以从一半（比如说 500）开始。另外，散点图坐标轴颗粒度要合适，最终聚成一团或者散列太大，都会让我们无法快速找到趋势。

​	第三，为了表示趋势的清晰，我们一般都会添加一条趋势线来表明背后的规律。说明一个趋势的趋势线只能有一条，不能有多条特别是出现趋势相交的情况。可别小看这个趋势线，这就是画龙点睛的一笔，背后其实是你对业务、数据、算法深刻的理解和认知。

### 散点图的易错点

####  趋势误判

​	趋势误判是指在你看到了一个数据之后，因为数据整体还不够完整，你错误判断了这个数据的未来增长趋势。

#### 得克萨斯神枪手谬误

​	背后所蕴含的实际数据是不是涵盖了所有的数据，还是只给你看了最有这种数据规律的数据。

#### 幸存者偏差

​	在分析散点图的时候看到了规律，还要了解最终这个规律形成的原因和背后的场景，不要简单通过一个图表就得出你的结论。

### 总结

​	要做一个正确的散点图，我们需要注意三个要点： 

1. 确定两个变量坐标轴；
2. 坐标轴的起始值和颗粒度要合适；
3. 要找到合适的趋势线和趋势模型进行描述。 

​	容易犯的错误： 

1. 利用散点图做深入数据分析的时候不要轻易下结论（身高和体重在生长期是成正比的，你成年了自然也就不会再是正比了）； 
2. 不能由现有结果给出趋势判断（做事情无论成功了还是失败了，都不要用上天的安排来麻痹自己），还需要了解规律形成的最终原因和背后的场景。 
3. 不要用片面的数据来证明你的规律（不要片面看问题）。